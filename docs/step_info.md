
# 1) –ö–∞–∫–∞—è —ç—Ç–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞?

**–°–ª–æ–∏—Å—Ç–∞—è (layered) —Å ‚Äú—á–∏—Å—Ç–æ–π‚Äù –∫–æ–º–ø–æ–Ω–æ–≤–∫–æ–π**, –±–ª–∏–∑–∫–æ –∫ **Clean / Hexagonal —Å—Ç–∏–ª—é** –±–µ–∑ —Ç—è–∂—ë–ª–æ–≥–æ –¥–æ–º–µ–Ω–Ω–æ–≥–æ —Å–ª–æ—è:

```
cmd/
  ‚Üí app/        (—Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: —Ä–æ—É—Ç–µ—Ä, –º–∏–¥–ª–≤–∞—Ä—ã, —Å–µ—Ä–≤–µ—Ä)
     ‚Üí http/    (handlers, middleware)
        ‚Üí core/ (–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞: –∫–æ–Ω—Ñ–∏–≥, –ª–æ–≥–∏, –æ—à–∏–±–∫–∏, –æ—Ç–≤–µ—Ç—ã)
           ‚Üí view (templates/assets ‚Äî –≤–Ω–µ Go-–∫–æ–¥–∞)
```

### –°–º—ã—Å–ª —Å–ª–æ—ë–≤:

* **cmd** ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –∏ –∑–∞–ø—É—Å–∫.
* **app** ‚Äî –∫–æ–º–ø–æ–∑–∏—Ü–∏—è: —Å–æ–∑–¥–∞—ë—Ç —Ä–æ—É—Ç–µ—Ä, –≤–µ—à–∞–µ—Ç middleware, –ø–æ–¥–∫–ª—é—á–∞–µ—Ç CSRF/—Å—Ç–∞—Ç–∏–∫—É, –≥–æ—Ç–æ–≤–∏—Ç http.Server.
* **http** ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã —É—Ä–æ–≤–Ω—è –≤–µ–±–∞: handlers (Home/About/Form/Health/404) –∏ middleware –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏/–∫—ç—à–∞.
* **core** ‚Äî —É—Ç–∏–ª–∏—Ç—ã/–∏–Ω—Ñ—Ä–∞: config, logging, —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—à–∏–±–æ–∫, JSON/RFC7807-–æ—Ç–≤–µ—Ç—ã.
* **view** ‚Äî HTML-—à–∞–±–ª–æ–Ω—ã –∏ —Å—Ç–∞—Ç–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–º–∏ –æ–ø–µ—Ä–∏—Ä—É—é—Ç handlers.

### 2. –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç? (–∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–ø—Ä–æ—Å–∞/–ø—Ä–æ—Ü–µ—Å—Å–∞)

**–ó–∞–ø—É—Å–∫**

1. `cmd/app/main.go`:
   –∑–∞–≥—Ä—É–∂–∞–µ—Ç **config**, –≤–∫–ª—é—á–∞–µ—Ç **–¥–Ω–µ–≤–Ω—ã–µ –ª–æ–≥–∏** —Å –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–æ–π, –¥–µ–ª–∞–µ—Ç sanity-–ø—Ä–æ–≤–µ—Ä–∫–∏ prod, —Å–æ–±–∏—Ä–∞–µ—Ç `handler = app.New(...)`, —Å–æ–∑–¥–∞—ë—Ç `srv = app.Server(...)`, —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç, –Ω–∞ SIGTERM ‚Äî **graceful shutdown** (10s).

**–°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
2. `internal/app/app.go`:
   —Å–æ–∑–¥–∞—ë—Ç `chi.Router` ‚Üí –ø–æ–¥–∫–ª—é—á–∞–µ—Ç **middleware**: RequestID, RealIP, Logger, Recoverer, Timeout(15s), **SecureHeaders**, HSTS(–µ—Å–ª–∏ `Secure`), CSRF(gorilla/csrf), –∫—ç—à —Å—Ç–∞—Ç–∏–∫–∏ –≤ prod ‚Üí —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –º–∞—Ä—à—Ä—É—Ç—ã (`/`, `/about`, `/form` GET/POST, `/healthz`) –∏ `NotFound`.

3. `internal/app/server.go`:
   –æ—Ç–¥–∞—ë—Ç `http.Server` —Å ¬´–±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏¬ª —Ç–∞–π–º–∞—É—Ç–∞–º–∏: ReadHeader 5s / Read 10s / Write 30s / Idle 60s.

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞**
4. –ö–ª–∏–µ–Ω—Ç ‚Üí `chi` —Ä–æ—É—Ç–µ—Ä ‚Üí —Ü–µ–ø–æ—á–∫–∞ **middleware**:

* –ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (CSP, XFO, nosniff, COOP, Permissions, Referrer).
* CSRF- –∑–∞—â–∏—Ç–∞ (—Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —à–∞–±–ª–æ–Ω–∞—Ö).
* –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ 15s.

5. –†–æ—É—Ç–∏–Ω–≥ —É–≤–æ–¥–∏—Ç –≤ –Ω—É–∂–Ω—ã–π **handler**:

    * `Home`/`About` —Ä–µ–Ω–¥–µ—Ä—è—Ç HTML (layout + partials + —Å—Ç—Ä–∞–Ω–∏—Ü–∞) –∏ –≤—Å—Ç–∞–≤–ª—è—é—Ç CSRF-–ø–æ–ª–µ.
    * `FormIndex` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É; `FormSubmit` –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –ø–æ–ª—è (`validator/v10`), –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö ‚Äî —Ä–µ—Ä–µ–Ω–¥–µ—Ä —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π, –ø—Ä–∏ —É—Å–ø–µ—Ö–µ ‚Äî **PRG-—Ä–µ–¥–∏—Ä–µ–∫—Ç** `/form?ok=1`. **–ë–î/email –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç.**
    * `Health` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{"status":"ok"}` (200).
    * –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—É—Ç—å ‚Üí `NotFound` (404-—Å—Ç—Ä–∞–Ω–∏—Ü–∞).
6. –ï—Å–ª–∏ –≤ —Ö–µ–Ω–¥–ª–µ—Ä–µ —Å–ª—É—á–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ –¥–ª—è API/JSON-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ ‚Äî —á–µ—Ä–µ–∑ `core/errors.go` + `core/response.go` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è **RFC7807**-–æ—Ç–≤–µ—Ç –∏ –ø–∏—à–µ—Ç—Å—è –ª–æ–≥.

**–õ–æ–≥–∏ –∏ —Ä–æ—Ç–∞—Ü–∏—è**
7. `core/logfile.go`:
   –≤—ã–≤–æ–¥ –∏–¥—ë—Ç —Å—Ä–∞–∑—É –≤ —Ñ–∞–π–ª **–∏** –≤ –∫–æ–Ω—Å–æ–ª—å; —Å—Ç—Ä–æ–∫–∏ —Å `ERROR` –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π error-–ª–æ–≥; —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π ‚Äî —É–¥–∞–ª—è—é—Ç—Å—è.

**–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ**
8. –ù–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫—É –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–µ—Ä–≤–µ—Ä –º—è–≥–∫–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (`Shutdown` —Å —Ç–∞–π–º–∞—É—Ç–æ–º), –ø–∏—à–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏.


## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

``` 

myApp/
‚îú‚îÄ cmd/
‚îÇ  ‚îî‚îÄ app/
‚îÇ     ‚îî‚îÄ main.go                    # entrypoint: –∫–æ–Ω—Ñ–∏–≥, –ª–æ–≥–∏, graceful, –∑–∞–ø—É—Å–∫ app.New()+Server
‚îÇ
‚îú‚îÄ internal/
‚îÇ  ‚îú‚îÄ app/
‚îÇ  ‚îÇ  ‚îú‚îÄ app.go                     # —Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: chi.Router + middleware + —Å—Ç–∞—Ç–∏–∫–∞ + –º–∞—Ä—à—Ä—É—Ç—ã + 404
‚îÇ  ‚îÇ  ‚îî‚îÄ server.go                  # http.Server —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ —Ç–∞–π–º–∞—É—Ç–∞–º–∏
‚îÇ  ‚îÇ
‚îÇ  ‚îú‚îÄ core/
‚îÇ  ‚îÇ  ‚îú‚îÄ config.go                  # –∫–æ–Ω—Ñ–∏–≥ (ENV), –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è prod
‚îÇ  ‚îÇ  ‚îú‚îÄ errors.go                  # AppError, —Ñ–∞–±—Ä–∏–∫–∏ (BadRequest, NotFound, Internal‚Ä¶)
‚îÇ  ‚îÇ  ‚îú‚îÄ response.go                # JSON(), NoContent(), Fail() (RFC 7807 style)
‚îÇ  ‚îÇ  ‚îî‚îÄ logfile.go                 # –ª–æ–≥–∏ –ø–æ –¥–∞—Ç–∞–º, –∞–≤—Ç–æ-—Ä–æ—Ç–∞—Ü–∏—è –∏ –æ—á–∏—Å—Ç–∫–∞
‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ http/
‚îÇ     ‚îú‚îÄ handler/
‚îÇ     ‚îÇ  ‚îú‚îÄ home.go                 # /
‚îÇ     ‚îÇ  ‚îú‚îÄ about.go                # /about
‚îÇ     ‚îÇ  ‚îú‚îÄ form.go                 # /form (GET/POST) + –≤–∞–ª–∏–¥–∞—Ü–∏—è validator/v10 + PRG
‚îÇ     ‚îÇ  ‚îî‚îÄ misc.go                 # /healthz (JSON) –∏ NotFound (404)
‚îÇ     ‚îÇ
‚îÇ     ‚îî‚îÄ middleware/
‚îÇ        ‚îî‚îÄ security.go             # CSP, XFO, Referrer, nosniff, Permissions, COOP, HSTS, CacheStatic, Keep-Alive
‚îÇ
‚îÇ
‚îú‚îÄ web/
‚îÇ  ‚îú‚îÄ assets/                      # —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã (CSS/JS/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è/—à—Ä–∏—Ñ—Ç—ã)
‚îÇ  ‚îî‚îÄ templates/
‚îÇ     ‚îú‚îÄ layouts/base.gohtml
‚îÇ     ‚îú‚îÄ partials/{nav,footer}.gohtml
‚îÇ     ‚îî‚îÄ pages/{home,about,form,404}.gohtml
‚îÇ
‚îú‚îÄ logs/                           # –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: DD-MM-YYYY.log (+ errors-DD-MM-YYYY.log, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
‚îú‚îÄ go.mod
‚îî‚îÄ go.sum

````

# –ü–æ —Ñ–∞–π–ª–∞–º

## `cmd/app/main.go`

* –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥ (`core.Load()`), –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ª–æ–≥–∏ —Å –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–æ–π (`core.InitDailyLog()`).
* Prod-–ø—Ä–æ–≤–µ—Ä–∫–∏: –Ω–∞–ª–∏—á–∏–µ `CSRF_KEY`, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ `Secure=false`.
* –°–±–æ—Ä–∫–∞ `http.Handler` (`app.New`) + –∑–∞–ø—É—Å–∫ `http.Server` (`app.Server`).
* –ì—Ä–∞—Ü–∏–æ–∑–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ —Å–∏–≥–Ω–∞–ª–∞–º (`SIGTERM`, `Ctrl+C`), —Ç–∞–π–º–∞—É—Ç –Ω–∞ shutdown ‚Äî 10s.
* `derive32()` ‚Äî SHA-256 –∏–∑ `CSRF_KEY` –¥–ª—è CSRF-–º–æ–¥—É–ª—è.

## `internal/app/app.go`

* –°–æ–∑–¥–∞—ë—Ç `chi.Router` –∏ —Ü–µ–ø–æ—á–∫—É middleware: `RequestID`, `RealIP`, `Logger`, `Recoverer`, `Timeout(15s)`.
* –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (`mw.SecureHeaders`), keep-alive hint; `HSTS` –ø—Ä–∏ `cfg.Secure`.
* –ü–æ–¥–∫–ª—é—á–∞–µ—Ç CSRF (`gorilla/csrf`) —Å `SameSite=Lax`, —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —à–∞–±–ª–æ–Ω–∞—Ö.
* –û—Ç–¥–∞—ë—Ç —Å—Ç–∞—Ç–∏–∫—É `web/assets` (+ –¥–æ–ª–≥–∏–π –∫—ç—à –≤ prod).
* –†–æ—É—Ç—ã: `/`, `/about`, `/form`(GET/POST), `/healthz`; `NotFound` –¥–ª—è 404.

## `internal/app/server.go`

* –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π `*http.Server`:

    * `ReadHeaderTimeout:5s`, `ReadTimeout:10s`, `WriteTimeout:30s`, `IdleTimeout:60s`.
* –¢–∞–π–º–∞—É—Ç—ã –∑–∞—â–∏—â–∞—é—Ç –æ—Ç –º–µ–¥–ª–µ–Ω–Ω—ã—Ö/–≤–∏—Å—è—á–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.

## `internal/core/config.go`

* –ß–∏—Ç–∞–µ—Ç ENV: `APP_NAME`, `HTTP_ADDR`, `APP_ENV`, `CSRF_KEY`, `SECURE`.
* –î–µ—Ñ–æ–ª—Ç—ã –¥–ª—è dev; –≤ prod –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç `CSRF_KEY` (–∑–∞–≤–µ—Ä—à–∞–µ—Ç –Ω–∞ –æ—à–∏–±–∫–µ).

## `internal/core/errors.go`

* `AppError`: –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫ (–∫–æ–¥, —Å—Ç–∞—Ç—É—Å, safe-—Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–µ—Ä–≤–æ–ø—Ä–∏—á–∏–Ω–∞, –ø–æ–ª—è).
* –§–∞–±—Ä–∏–∫–∏: `BadRequest`, `NotFound`, `Forbidden`, `Unauthorized`, `Internal`.
* `From(err)` –ø—Ä–∏–≤–æ–¥–∏—Ç –ª—é–±—É—é –æ—à–∏–±–∫—É –∫ `*AppError` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 500).

## `internal/core/logfile.go`

* –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ª–æ–≥–∏ –≤ `logs/–î–î-–ú–ú-–ì–ì–ì–ì.log` –∏ –æ—à–∏–±–∫–∏ –≤ `logs/errors-–î–î-–ú–ú-–ì–ì–ì–ì.log`.
* –î—É–±–ª–∏—Ä—É–µ—Ç –≤—ã–≤–æ–¥ –≤ —Ñ–∞–π–ª + –∫–æ–Ω—Å–æ–ª—å; —Å—Ç—Ä–æ–∫–∏ —Å `ERROR` ‚Äî –µ—â—ë –∏ –≤ error-–ª–æ–≥.
* –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —É–¥–∞–ª—è–µ—Ç –ª–æ–≥–∏ —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π.

## `internal/core/response.go`

* `JSON(w,status,v)` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è JSON-–æ—Ç–≤–µ—Ç–∫–∞.
* `NoContent(w)` ‚Äî `204`.
* `ProblemDetail` (RFC 7807) –∏ `Fail(w,r,err)` ‚Äî –ª–æ–≥–∏—Ä—É–µ—Ç –∏ –æ—Ç–¥–∞—ë—Ç —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é JSON-–æ—à–∏–±–∫—É.

## `internal/http/handler/home.go`

* –†–µ–Ω–¥–µ—Ä–∏—Ç –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É (`base`, `nav`, `footer`, `home`), –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç `Content-Type`, –¥–æ–±–∞–≤–ª—è–µ—Ç CSRF-–ø–æ–ª–µ.

## `internal/http/handler/about.go`

* –†–µ–Ω–¥–µ—Ä–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É ¬´–û –Ω–∞—Å¬ª (`base`, `nav`, `footer`, `about`), —Å CSRF-–ø–æ–ª–µ–º.

## `internal/http/handler/form.go`

* –ü–æ–∫–∞–∑ —Ñ–æ—Ä–º—ã (`FormIndex`): —à–∞–±–ª–æ–Ω—ã, `ok=1` —Ñ–ª–∞–≥ —É—Å–ø–µ—Ö–∞, CSRF-–ø–æ–ª–µ.
* –û—Ç–ø—Ä–∞–≤–∫–∞ (`FormSubmit`): —Ç–æ–ª—å–∫–æ `POST`, `ParseForm`, `TrimSpace`, –≤–∞–ª–∏–¥–∞—Ü–∏—è (`validator/v10`), —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–µ –æ—à–∏–±–∫–∏.
* –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö ‚Äî —Ä–µ—Ä–µ–Ω–¥–µ—Ä —Ñ–æ—Ä–º—ã —Å –æ—à–∏–±–∫–∞–º–∏; –ø—Ä–∏ —É—Å–ø–µ—Ö–µ ‚Äî PRG-—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/form?ok=1`.
* –ü–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é: **–Ω–µ—Ç** –∑–∞–ø–∏—Å–∏ –≤ –ë–î –∏ **–Ω–µ—Ç** –æ—Ç–ø—Ä–∞–≤–∫–∏ email.

## `internal/http/handler/common.go`

* `Health` ‚Äî `200` + `{"status":"ok"}` (–ø—Ä–æ—Å—Ç–æ–π healthcheck).
* `NotFound` ‚Äî `404` —Ä–µ–Ω–¥–µ—Ä –∫–∞—Å—Ç–æ–º–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

## `internal/http/middleware/security.go`

* `SecureHeaders` ‚Äî CSP, XFO=DENY, X-Content-Type-Options=nosniff, Referrer-Policy, Permissions-Policy, COOP.
* `HSTS` ‚Äî —Å—Ç—Ä–æ–≥–∏–π HTTPS (–≤–∫–ª—é—á–∞—Ç—å –ø—Ä–∏ `Secure=true`).
* `CacheStatic` ‚Äî `Cache-Control: public, max-age=31536000, immutable` –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ (prod).
* `ServerKeepAliveHint` ‚Äî –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç `Keep-Alive: timeout=60`.

---

# –ü–æ –≤—Å–µ–º—É –ø—Ä–æ–µ–∫—Ç—É (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å–≤–æ–¥–∫–∞ —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ —Ñ–∞–π–ª–∞–º)

**–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –∏ –∑–∞–ø—É—Å–∫**

* `cmd/app/main.go`: —á–∏—Ç–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥ (`core/config.go`), –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ª–æ–≥–∏ (`core/logfile.go`), —Å–æ–±–∏—Ä–∞–µ—Ç HTTP-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`internal/app/app.go`), —Å–æ–∑–¥–∞—ë—Ç —Å–µ—Ä–≤–µ—Ä (`internal/app/server.go`), –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≥–∞—Å–∏—Ç –ø–æ —Å–∏–≥–Ω–∞–ª–∞–º.

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**

* `internal/core/config.go`: ENV-–∫–æ–Ω—Ñ–∏–≥ + –ø—Ä–æ–¥-–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–∞.
* `internal/core/logfile.go`: –¥–Ω–µ–≤–Ω—ã–µ –ª–æ–≥–∏ + –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞.
* `internal/core/errors.go` + `internal/core/response.go`: –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫ (`AppError`) –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ JSON-–æ—Ç–≤–µ—Ç—ã (RFC 7807).

**–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**

* `internal/app/app.go`: `chi.Router`, –æ–±—â–∏–µ middleware (–≤–∫–ª—é—á–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å), CSRF, —Å—Ç–∞—Ç–∏–∫–∞, –∫—ç—à —Å—Ç–∞—Ç–∏–∫–∏ (prod), —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏ 404.
* `internal/app/server.go`: –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã HTTP.

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

* `internal/http/middleware/security.go`: CSP/—Å–µ–∫-–∑–∞–≥–æ–ª–æ–≤–∫–∏, HSTS, cache-headers, keep-alive hint.

**–ë–∏–∑–Ω–µ—Å-–º–∞—Ä—à—Ä—É—Ç—ã –∏ —Ä–µ–Ω–¥–µ—Ä**

* `internal/http/handler/`:

    * `home.go`, `about.go`: —Ä–µ–Ω–¥–µ—Ä HTML-—Å—Ç—Ä–∞–Ω–∏—Ü (layout + partials), CSRF-–ø–æ–ª–µ.
    * `form.go`: —Ñ–æ—Ä–º–∞ (GET/POST), –≤–∞–ª–∏–¥–∞—Ü–∏—è, UX —á–µ—Ä–µ–∑ PRG, –±–µ–∑ –ë–î/email.
    * `common.go`: `Health` JSON –∏ `NotFound` 404-—Å—Ç—Ä–∞–Ω–∏—Ü–∞.

**–°—Ç–∞—Ç–∏–∫–∞ –∏ —à–∞–±–ª–æ–Ω—ã**

* –û—Ç–¥–∞—é—Ç—Å—è –∏–∑ `/assets` (`internal/app/app.go`), –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ prod.
* –®–∞–±–ª–æ–Ω—ã: `web/templates/layouts/`, `partials/`, `pages/` (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–æ –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö).


# –ß—Ç–æ —É–∂–µ —Ö–æ—Ä–æ—à–æ —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é (–∏–∑ –∫–æ—Ä–æ–±–∫–∏)

* **CSRF-–∑–∞—â–∏—Ç–∞** (`gorilla/csrf`): —Ç–æ–∫–µ–Ω –≤ —Ñ–æ—Ä–º–∞—Ö, `SameSite=Lax`, `HttpOnly`, `Secure` –≤ –ø—Ä–æ–¥–µ.
* **–ñ—ë—Å—Ç–∫–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏** (`middleware.SecureHeaders`):

    * CSP (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤), `X-Frame-Options=DENY`, `X-Content-Type-Options=nosniff`,
    * `Permissions-Policy`, `Referrer-Policy`, `Cross-Origin-Opener-Policy`.
* **HSTS** –≤ –ø—Ä–æ–¥–µ (`middleware.HSTS`): –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π HTTPS –Ω–∞ –≥–æ–¥.
* **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã** —Å–µ—Ä–≤–µ—Ä–∞: –∑–∞—â–∏—Ç–∞ –æ—Ç slowloris/–≤–∏—Å—è—á–∏—Ö –∫–æ–Ω–Ω–µ–∫—Ç–æ–≤.
* **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–∞** (`validator/v10`) –∏ **PRG-—Ä–µ–¥–∏—Ä–µ–∫—Ç** –ø–æ—Å–ª–µ POST ‚Äî –º–µ–Ω—å—à–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫.
* **–®–∞–±–ª–æ–Ω—ã Go** ‚Äî –∞–≤—Ç–æ-—ç—Å–∫–µ–π–ø–∏–Ω–≥ HTML (XSS-–±–∞–∑–∏—Å –∑–∞–∫—Ä—ã—Ç).
* **–õ–æ–≥–∏ –±–µ–∑ PII** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–≤—ã —Å–∞–º–∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç–µ, —á—Ç–æ –ø–∏—Å–∞—Ç—å).
* **–°–∞–Ω–∏—Ç–∏-—á–µ–∫–∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞**: –∑–∞–ø—Ä–µ—Ç –¥–µ—Ñ–æ–ª—Ç–Ω–æ–≥–æ CSRF-–∫–ª—é—á–∞.

# –ù–∞ —á—Ç–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ / —á—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å (–ø–æ –º–µ—Å—Ç—É –≤ –ø—Ä–æ–µ–∫—Ç–µ)

1. **Rate limiting & –∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞**
   –î–æ–±–∞–≤–∏—Ç—å middleware-–ª–∏–º–∏—Ç–µ—Ä (–ø–æ IP/–∫–ª—é—á—É) –ø–µ—Ä–µ–¥ —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏ –≤–≤–æ–¥–∞.
   *–ì–¥–µ*: `internal/http/middleware` + –≤–∫–ª—é—á–∏—Ç—å –≤ —Ü–µ–ø–æ—á–∫—É –≤ `app/app.go`.

2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–æ–≤**
   –î–ª—è —Ñ–æ—Ä–º/API ‚Äî `http.MaxBytesReader` + –ø—Ä–æ–≤–µ—Ä–∫–∞ `Content-Length`.
   *–ì–¥–µ*: –≤ `FormSubmit` –∏ –±—É–¥—É—â–∏—Ö JSON-—Ä—É—á–∫–∞—Ö.

3. **–°—Ç—Ä–æ–∂–µ CSP**
   –ü–µ—Ä–µ–π—Ç–∏ —Å –æ–±—â–∏—Ö –ø—Ä–∞–≤–∏–ª –Ω–∞ `nonce`/`sha256` –¥–ª—è –∏–Ω–ª–∞–π–Ω-—Å–∫—Ä–∏–ø—Ç–æ–≤, —É–±—Ä–∞—Ç—å `unsafe-inline` –¥–ª—è —Å—Ç–∏–ª–µ–π, –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.
   *–ì–¥–µ*: `middleware.SecureHeaders`.

4. **TLS/–ø—Ä–æ–∫—Å–∏ –∏ ‚ÄúSecure‚Äù —Ä–µ–∂–∏–º**
   –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `cfg.Secure` –ø—Ä–∏–≤—è–∑–∞–Ω –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É HTTPS (–∑–∞ –ø—Ä–æ–∫—Å–∏ –≤—ã—Å—Ç–∞–≤–ª—è—Ç—å `X-Forwarded-Proto` –∏ –¥–æ–≤–µ—Ä—è—Ç—å –¢–û–õ–¨–ö–û —Å–≤–æ–µ–º—É –ø—Ä–æ–∫—Å–∏).
   *–ì–¥–µ*: `core/config.go` + –≤–æ–∑–º–æ–∂–Ω–æ trust-proxy middleware.

5. **–°–µ—Å—Å–∏–∏/–∫—É–∫–∏ (–µ—Å–ª–∏ –ø–æ—è–≤—è—Ç—Å—è –ª–æ–≥–∏–Ω—ã)**
   `HttpOnly`, `Secure`, `SameSite=Strict/Lax`, –∫–æ—Ä–æ—Ç–∫–∏–µ TTL, –∫–ª—é—á–∏ –∏–∑ ENV.
   *–ì–¥–µ*: –Ω–æ–≤—ã–π –ø–∞–∫–µ—Ç `internal/http/session` –∏–ª–∏ middleware.

6. **CORS (–µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç–µ API –¥–ª—è —Ñ—Ä–æ–Ω—Ç–∞ –Ω–∞ –¥—Ä—É–≥–æ–º –¥–æ–º–µ–Ω–µ)**
   –Ø–≤–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –≤—Å—ë –∏ –æ—Ç–∫—Ä—ã—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ origins/–º–µ—Ç–æ–¥—ã/–∑–∞–≥–æ–ª–æ–≤–∫–∏.
   *–ì–¥–µ*: middleware CORS –≤ `internal/http/middleware`.

7. **–û—á–∏—Å—Ç–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
   –£–∂–µ –µ—Å—Ç—å `TrimSpace`; –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é email/Unicode –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
   *–ì–¥–µ*: –≤ —Ö–µ–Ω–¥–ª–µ—Ä–∞—Ö –∏ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞—Ö.

8. **–°–∫—Ä—ã—Ç–∏–µ –≤–µ—Ä—Å–∏–∏/–∏–Ω—Ñ—Ä—ã**
   –ù–µ –æ—Ç–¥–∞–≤–∞—Ç—å –ª–∏—à–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏/–±–∞–Ω–Ω–µ—Ä—ã.
   *–ì–¥–µ*: —Å–µ—Ä–≤–µ—Ä/—Ä–µ–≤–µ—Ä—Å-–ø—Ä–æ–∫—Å–∏ –∫–æ–Ω—Ñ–∏–≥ + –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –∫–æ–¥–µ (–∏ —ç—Ç–æ —Ö–æ—Ä–æ—à–æ).

9. **Healthcheck –¥–æ—Å—Ç—É–ø**
   `GET /healthz` –ª—É—á—à–µ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø–æ —Å–µ—Ç–∏/–ø—Ä–æ–∫—Å–∏ (–∏–ª–∏ –æ—Ç–¥–∞–≤–∞—Ç—å –º–∏–Ω–∏–º—É–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏).
   *–ì–¥–µ*: –≤ ingress/–ø—Ä–æ–∫—Å–∏, –ª–∏–±–æ –ø—Ä–æ—Å—Ç–µ–π—à–∏–π IP-—Ñ–∏–ª—å—Ç—Ä middleware.

10. **–õ–æ–≥–∏ –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å**
    –°–ª–µ–¥–∏—Ç—å, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã (PII) –Ω–µ –ø–æ–ø–∞–¥–∞–ª–∏ –≤ ERROR-–ª–æ–≥–∏.
    *–ì–¥–µ*: –ø—Ä–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏ –æ—à–∏–±–æ–∫/–≤–∞–ª–∏–¥–∞—Ü–∏–∏.

11. **–ö–ª—é—á–∏**
    CSRF-–∫–ª—é—á ‚Äî 32 –±–∞–π—Ç–∞ –∫—Ä–∏–ø—Ç–æ—Å–ª—É—á–∞–π–Ω—ã–π (ENV), —Ä–æ—Ç–∞—Ü–∏—è –ø–æ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—É.
    *–ì–¥–µ*: `APP_ENV=prod` ‚Äî —É–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è; –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞–¥—ë–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

–ò—Ç–æ–≥: –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è ‚Äú—á–∏—Å—Ç–æ–≥–æ‚Äù –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –≤–µ–±-—Å–µ—Ä–≤–∏—Å–∞ –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞. –ë–∞–∑–æ–≤—ã–µ —Ä–∏—Å–∫–∏ (CSRF, XSS, slowloris, –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏) —É–∂–µ –ø—Ä–∏–∫—Ä—ã—Ç—ã. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –¥–æ–±–∞–≤—å—Ç–µ –ª–∏–º–∏—Ç–µ—Ä, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–ª–∞, —Å—Ç—Ä–æ–≥–∏–π CSP —Å nonce, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É –∑–∞ –ø—Ä–æ–∫—Å–∏ –∏, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, CORS/—Å–µ—Å—Å–∏–∏ ‚Äî —ç—Ç–æ –¥–æ–≤–µ–¥—ë—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–æ ¬´–±–æ–µ–≤–æ–≥–æ¬ª —É—Ä–æ–≤–Ω—è.
